---
description: テストコード作成（Vitest/Testing Library対応）
argument-hint: [対象ファイル]
---

以下のコードに対するテストを作成してください: $ARGUMENTS

## テスト作成方針

### 基本原則
- **実装ではなく振る舞いをテスト** - 内部実装に依存しないテストを書く
- **ユーザー視点でテスト** - ユーザーがどう操作するかを基準にする
- **1テスト1検証** - 各テストは1つのことだけを検証する
- **テスト名は日本語で具体的に** - 何をテストしているか明確にわかる命名

### テスト構造
- Arrange（準備）→ Act（実行）→ Assert（検証）の構造を守る
- describe でテストをグループ化（日本語）
- beforeEach/afterEach で適切にセットアップ・クリーンアップ

### カバレッジ対象
1. **正常系** - 期待通りの入力での動作
2. **異常系** - エラーケース、例外処理
3. **境界値** - 空配列、null、undefined、0、空文字
4. **エッジケース** - 極端な入力値、特殊文字

## フロントエンド（React/Next.js）の場合

### React Testing Library ベストプラクティス
- `getByRole` を優先的に使用（アクセシビリティも検証できる）
- `getByText`, `getByLabelText` を次点で使用
- `getByTestId` は最終手段
- `fireEvent` より `userEvent` を使用
- `screen` オブジェクトを使用してクエリ

### テスト対象
- レンダリング結果
- ユーザーインタラクション（クリック、入力など）
- 条件付きレンダリング
- props による表示変化
- 非同期処理（ローディング、エラー状態）

## バックエンド（Node.js/API）の場合

### ユニットテスト
- 関数単位でテスト
- 外部依存（DB、API）はモック化
- 純粋関数は入出力のみテスト

### モック方針
- `vi.mock()` で外部モジュールをモック
- `vi.spyOn()` で部分的にモック
- モックは最小限に（過度なモックは避ける）

## 出力形式
```typescript
import { describe, it, expect, beforeEach, vi } from 'vitest';
// 必要なインポート

describe('対象の名前', () => {
  describe('メソッド名 / 機能名', () => {
    it('正常な値を渡した場合、期待する結果を返すこと', () => {
      // Arrange（準備）
      // Act（実行）
      // Assert（検証）
    });

    it('空文字を渡した場合、エラーをスローすること', () => {
      // ...
    });
  });
});
```

## 注意点

- テストの説明文（describe, it）は日本語で記述
- 既存のテストファイルがあれば、そのスタイルに合わせる
- スナップショットテストは構造確認が目的の場合のみ使用
- 非同期テストは `async/await` を適切に使用
